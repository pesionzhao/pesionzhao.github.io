
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../Basic/">
      
      
        <link rel="next" href="../BasicMath/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.2.7">
    
    
      
        <title>反演基础 - ZPSXJTU</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.046329b4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.85d0ee34.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noto+Sans:300,300i,400,400i,700,700i%7CSource+Code+Pro:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Noto Sans";--md-code-font:"Source Code Pro"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="Slate" data-md-color-primary="Blue-Grey" data-md-color-accent="red">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#segy" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href="../.." title="ZPSXJTU" class="md-header__button md-logo" aria-label="ZPSXJTU" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 3 1 9l11 6 9-4.91V17h2V9M5 13.18v4L12 21l7-3.82v-4L12 17l-7-3.82Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            ZPSXJTU
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              反演基础
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
        <button type="reset" class="md-search__icon md-icon" title="清空当前内容" aria-label="清空当前内容" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="标签" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../%E7%BB%8F%E9%AA%8C%E4%B9%8B%E8%B0%88/" class="md-tabs__link">
          
  
  经验之谈

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../%E8%AE%BA%E6%96%87%E7%AC%94%E8%AE%B0/" class="md-tabs__link">
          
  
  论文笔记

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../%E8%B8%A9%E5%9D%91%E8%AE%B0%E5%BD%95/" class="md-tabs__link">
          
  
  踩坑记录

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
  地震反演

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="ZPSXJTU" class="md-nav__button md-logo" aria-label="ZPSXJTU" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 3 1 9l11 6 9-4.91V17h2V9M5 13.18v4L12 21l7-3.82v-4L12 17l-7-3.82Z"/></svg>

    </a>
    ZPSXJTU
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    经验之谈
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            经验之谈
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../%E7%BB%8F%E9%AA%8C%E4%B9%8B%E8%B0%88/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    专栏介绍
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../%E7%BB%8F%E9%AA%8C%E4%B9%8B%E8%B0%88/%E5%8D%95%E7%9B%B8%E6%9C%BA%E5%8F%8C%E5%85%89%E6%BA%90%E8%A7%86%E7%BA%BF%E4%BC%B0%E8%AE%A1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    基于单相机双光源的眼动交互
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../%E7%BB%8F%E9%AA%8C%E4%B9%8B%E8%B0%88/%E8%8D%A7%E5%85%89%E9%98%B5%E5%88%97%E7%9F%AB%E6%AD%A3%E8%AE%A1%E6%95%B0/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    蛋白质荧光阵列矫正与计数
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../%E7%BB%8F%E9%AA%8C%E4%B9%8B%E8%B0%88/JLU%20Captcha/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    吉林大学教务管理系统验证码识别
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../%E7%BB%8F%E9%AA%8C%E4%B9%8B%E8%B0%88/robomaster%E5%B7%A5%E7%A8%8B%E7%9F%BF%E7%9F%B3%E8%AF%86%E5%88%AB/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    robomaster工程矿石识别
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../%E7%BB%8F%E9%AA%8C%E4%B9%8B%E8%B0%88/%E7%99%BE%E5%BA%A6%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%AB%9E%E8%B5%9B%E5%88%92%E6%B0%B4%E8%AE%B0%E5%BD%95/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    百度车载影像检测与分割
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    论文笔记
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            论文笔记
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../%E8%AE%BA%E6%96%87%E7%AC%94%E8%AE%B0/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    专栏介绍
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    网络解读
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            网络解读
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../%E8%AE%BA%E6%96%87%E7%AC%94%E8%AE%B0/Transformer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    屠榜的transformer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../%E8%AE%BA%E6%96%87%E7%AC%94%E8%AE%B0/%E5%90%8A%E6%89%93%E4%B8%80%E5%88%87%E7%9A%84yolox/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    吊打一切的yoloX
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../%E8%AE%BA%E6%96%87%E7%AC%94%E8%AE%B0/CascadeRCNN/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CascadeRCNN永远滴神
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../%E8%AE%BA%E6%96%87%E7%AC%94%E8%AE%B0/HR-Net%20%E8%AE%BA%E6%96%87%E8%A7%A3%E8%AF%BB/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    高分辨网络HR-Net
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../%E8%AE%BA%E6%96%87%E7%AC%94%E8%AE%B0/%E5%B0%8F%E7%9B%AE%E6%A0%87%E5%B0%81%E7%A5%9ETPH-YOLOV5/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    小目标检测王者TPH-YOLOV5
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../%E8%AE%BA%E6%96%87%E7%AC%94%E8%AE%B0/YOLOP/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    嵌入式同时完成三大视觉任务YOLOP
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    理论基础
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            理论基础
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../%E8%AE%BA%E6%96%87%E7%AC%94%E8%AE%B0/%E5%9F%BA%E7%A1%80%E7%90%86%E8%A7%A3/Soft%20label/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    从标签平滑和知识蒸馏看Soft Label
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" >
        
          <label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    即插即用
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            即插即用
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../%E8%AE%BA%E6%96%87%E7%AC%94%E8%AE%B0/%E5%8D%B3%E6%8F%92%E5%8D%B3%E7%94%A8/UMOP/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    百度开源UMOP解决特征层gt不匹配
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    踩坑记录
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            踩坑记录
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../%E8%B8%A9%E5%9D%91%E8%AE%B0%E5%BD%95/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    专栏介绍
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../%E8%B8%A9%E5%9D%91%E8%AE%B0%E5%BD%95/%E5%9F%BA%E7%A1%80/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    基础
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../%E8%B8%A9%E5%9D%91%E8%AE%B0%E5%BD%95/nano%E9%83%A8%E7%BD%B2yolov5/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    nano部署yolov5
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../%E8%B8%A9%E5%9D%91%E8%AE%B0%E5%BD%95/LibtorchInWindows/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    windows下配置libtorch(vs/cmake)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../%E8%B8%A9%E5%9D%91%E8%AE%B0%E5%BD%95/vscode%E9%85%8D%E7%BD%AEopencv/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    windows+vscode配置opencv4.1.1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../%E8%B8%A9%E5%9D%91%E8%AE%B0%E5%BD%95/%E6%96%B0%E7%94%B5%E8%84%91%E9%85%8D%E7%8E%AF%E5%A2%83/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    windows配置深度学习环境
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../%E8%B8%A9%E5%9D%91%E8%AE%B0%E5%BD%95/ubuntu%E5%8F%8C%E7%B3%BB%E7%BB%9F%E5%AE%89%E8%A3%85%E4%B8%8E%E5%8D%B8%E8%BD%BD/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    win11+ubuntu双系统的安装与卸载
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../%E8%B8%A9%E5%9D%91%E8%AE%B0%E5%BD%95/WSL%E4%B8%8B%E9%85%8D%E7%BD%AEdocker%E7%8E%AF%E5%A2%83/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    WSL下GPU配置与docker安装
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../%E8%B8%A9%E5%9D%91%E8%AE%B0%E5%BD%95/%E5%87%BD%E6%95%B0%E4%BD%BF%E7%94%A8%E6%96%87%E6%A1%A3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    函数使用文档
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    地震反演
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            地震反演
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    专栏介绍
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../Basic/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    反演概念
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    反演基础
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    反演基础
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#segy" class="md-nav__link">
    SEGY地震数据
  </a>
  
    <nav class="md-nav" aria-label="SEGY地震数据">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    简介
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    存储格式
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    具体代码
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    子波
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#avo" class="md-nav__link">
    AVO建模
  </a>
  
    <nav class="md-nav" aria-label="AVO建模">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#avoab-method" class="md-nav__link">
    两项AVO方程(AB method)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aki-richards" class="md-nav__link">
    Aki-Richards方程
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aki-richardswigginsabc-method" class="md-nav__link">
    Aki-Richards方程的Wiggins形式(ABC method)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aki-richardsfatti" class="md-nav__link">
    Aki-Richards方程的Fatti形式
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aki-richards_1" class="md-nav__link">
    对于Aki-Richards方程小结
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#shueyavo" class="md-nav__link">
    Shuey两项AVO方程
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#avo_1" class="md-nav__link">
    AVO分析（估计截距与梯度）
  </a>
  
    <nav class="md-nav" aria-label="AVO分析（估计截距与梯度）">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    从偏移距道集数据转换到角度道集数据
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    拟合一个回归曲线来匹配振幅拾取值，这是一个角度平方的正弦函数关系.
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    正演相关代码
  </a>
  
    <nav class="md-nav" aria-label="正演相关代码">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aki-richards_2" class="md-nav__link">
    Aki-Richards线性近似
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zoeppritz" class="md-nav__link">
    Zoeppritz方程
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aki-richards-equation" class="md-nav__link">
    Aki-Richards-equation非线性近似
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../BasicMath/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    数学基础
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_5" >
        
          <label class="md-nav__link" for="__nav_5_5" id="__nav_5_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    论文笔记
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_5">
            <span class="md-nav__icon md-icon"></span>
            论文笔记
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../PaperNotes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    碎片
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../Paper/DTV/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DTV
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../Paper/Gan/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    生成对抗网络
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../Paper/unet/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Unet迁移学习
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../Paper/Review/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Review
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../Optimization/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    优化方法笔记
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#segy" class="md-nav__link">
    SEGY地震数据
  </a>
  
    <nav class="md-nav" aria-label="SEGY地震数据">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    简介
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    存储格式
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    具体代码
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    子波
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#avo" class="md-nav__link">
    AVO建模
  </a>
  
    <nav class="md-nav" aria-label="AVO建模">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#avoab-method" class="md-nav__link">
    两项AVO方程(AB method)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aki-richards" class="md-nav__link">
    Aki-Richards方程
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aki-richardswigginsabc-method" class="md-nav__link">
    Aki-Richards方程的Wiggins形式(ABC method)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aki-richardsfatti" class="md-nav__link">
    Aki-Richards方程的Fatti形式
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aki-richards_1" class="md-nav__link">
    对于Aki-Richards方程小结
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#shueyavo" class="md-nav__link">
    Shuey两项AVO方程
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#avo_1" class="md-nav__link">
    AVO分析（估计截距与梯度）
  </a>
  
    <nav class="md-nav" aria-label="AVO分析（估计截距与梯度）">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    从偏移距道集数据转换到角度道集数据
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    拟合一个回归曲线来匹配振幅拾取值，这是一个角度平方的正弦函数关系.
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    正演相关代码
  </a>
  
    <nav class="md-nav" aria-label="正演相关代码">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aki-richards_2" class="md-nav__link">
    Aki-Richards线性近似
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zoeppritz" class="md-nav__link">
    Zoeppritz方程
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aki-richards-equation" class="md-nav__link">
    Aki-Richards-equation非线性近似
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>反演基础</h1>

<h2 id="segy">SEGY地震数据<a class="headerlink" href="#segy" title="Permanent link">&para;</a></h2>
<h3 id="_1">简介<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h3>
<p>SEGY（Seismic Exploration Geophysical Data）格式是一种常见的用于存储地震勘探数据的标准格式。SEGY格式的数据通常存储在磁盘文件中，文件通常以“.sgy”或“.segy”作为扩展名。</p>
<p>SEGY文件由三部分组成：文件头（File Header）、道头（Trace Header）和数据部分（Data Section）。</p>
<p>文件头包含了所有道的通用信息，例如数据的采样率、数据类型、地震仪器的参数等。文件头通常包含3200个字节的信息。</p>
<p>道头包含了单个地震道的信息，例如该道的坐标位置、时间信息、道号等。道头的长度通常为240个字节。</p>
<p>数据部分包含了所有的地震数据，每个数据点都是一个16位或32位的整数。在SEGY格式中，数据是以“道”（Trace）的形式组织的，每个道代表了一次地震记录的结果，道的数量取决于勘探过程中所采集的数据点数和勘探面积的大小。</p>
<p>总之，SEGY格式是一种灵活的地震数据存储方式，它可以方便地存储大量的地震勘探数据，并且能够提供高效的数据读取和处理能力。</p>
<p>SEGY格式可以分为IBM格式和IEEE格式两种存储方式。</p>
<p>IBM格式是指IBM公司的二进制浮点数格式，也称为"big-endian"（大端）格式。在IBM格式中，浮点数存储为四个字节的二进制数，其中第一个字节表示符号位和指数部分，而后三个字节表示小数部分。在IBM格式中，数据的字节顺序是从左到右的，即最高位字节存储在最左边，最低位字节存储在最右边。因此，IBM格式也称为"大端字节序"（big-endian byte order）。</p>
<p>IEEE格式是指基于IEEE标准的二进制浮点数格式，也称为"little-endian"（小端）格式。在IEEE格式中，浮点数存储为四个字节的二进制数，其中第一个字节表示小数部分，而后三个字节表示符号位和指数部分。在IEEE格式中，数据的字节顺序是从右到左的，即最低位字节存储在最左边，最高位字节存储在最右边。因此，IEEE格式也称为"小端字节序"（little-endian byte order）。</p>
<h3 id="_2">存储格式<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h3>
<p>具体存储格式见下文件附录</p>
<p><a href="https://www.doc88.com/p-6857792235992.html">用 C 语言读写 SGY 格式的地震数据</a></p>
<p>可以通过将地震数据读取到hampson russell中，点击header editor查看文件头与道头各个位置对应的数据，便于调试</p>
<h3 id="_3">具体代码<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">struct</span>

<span class="c1"># 打开SEGY文件</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;gathers.sgy&#39;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>

    <span class="c1"># 读取二进制文件头</span>
    <span class="n">bin_header</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">3600</span><span class="p">)</span>

    <span class="c1"># 获取文件头中的相关信息</span>
    <span class="n">sample_interval</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack_from</span><span class="p">(</span><span class="s2">&quot;&gt;h&quot;</span><span class="p">,</span> <span class="n">bin_header</span><span class="p">,</span> <span class="mi">3216</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># &gt;h表示大端short</span>
    <span class="n">num_samples</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack_from</span><span class="p">(</span><span class="s2">&quot;&gt;h&quot;</span><span class="p">,</span> <span class="n">bin_header</span><span class="p">,</span> <span class="mi">3220</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># 读取所有道数据</span>
    <span class="n">traces</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># 某一CDP的道集</span>
    <span class="n">offset</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># 同一CDP道集不同数据对应的偏移距</span>
    <span class="n">cdp</span> <span class="o">=</span> <span class="mi">330</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">trace_header</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">240</span><span class="p">)</span> <span class="c1"># 读取道头</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">trace_header</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="n">cdp_cur</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack_from</span><span class="p">(</span><span class="s2">&quot;&gt;i&quot;</span><span class="p">,</span> <span class="n">trace_header</span><span class="p">,</span> <span class="mi">20</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># 道头CDP</span>
        <span class="k">if</span> <span class="n">cdp_cur</span> <span class="o">==</span> <span class="n">cdp</span><span class="p">:</span>
            <span class="n">amp</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_samples</span><span class="p">):</span>
                <span class="n">amp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">struct</span><span class="o">.</span><span class="n">unpack_from</span><span class="p">(</span><span class="s2">&quot;&gt;h&quot;</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">2</span><span class="p">))[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># 这里的地震数据是两字节的short</span>
            <span class="n">traces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">amp</span><span class="p">)</span>
            <span class="n">offset</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">struct</span><span class="o">.</span><span class="n">unpack_from</span><span class="p">(</span><span class="s2">&quot;&gt;i&quot;</span><span class="p">,</span> <span class="n">trace_header</span><span class="p">,</span> <span class="mi">36</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># 道头偏移距</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">num_samples</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span> <span class="c1"># 更改文件指针</span>
            <span class="k">continue</span>
</code></pre></div>
<h2 id="_4">子波<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h2>
<p>常用的为Ricker子波</p>
<p>生成Ricker子波代码为</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">z_ricker</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">f0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Args:</span>
<span class="sd">        t: 时域抽样点,都为正值</span>
<span class="sd">        f0: 主频</span>

<span class="sd">    Returns:</span>
<span class="sd">        Ricker子波时域幅值</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">flipud</span><span class="p">(</span><span class="o">-</span><span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">:]),</span> <span class="n">t</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># 将时域映射至整个实轴</span>
    <span class="n">w</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">f0</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">f0</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>  <span class="c1"># Ricker子波计算公式</span>
    <span class="k">return</span> <span class="n">w</span>
</code></pre></div>
<h2 id="avo">AVO建模<a class="headerlink" href="#avo" title="Permanent link">&para;</a></h2>
<h3 id="avoab-method">两项AVO方程(AB method)<a class="headerlink" href="#avoab-method" title="Permanent link">&para;</a></h3>
<div class="arithmatex">
<div class="MathJax_Preview">
R(\theta) = R_0+B\sin^2(\theta)
</div>
<script type="math/tex; mode=display">
R(\theta) = R_0+B\sin^2(\theta)
</script>
</div>
<p>其中<span class="arithmatex"><span class="MathJax_Preview">R_0</span><script type="math/tex">R_0</script></span>代表零偏移距反射系数，即截距，<span class="arithmatex"><span class="MathJax_Preview">B</span><script type="math/tex">B</script></span>代表梯度,可以在很大程度上简化分析
,对于角度小于 40 度的情况, 第三项不是非常重要</p>
<h3 id="aki-richards">Aki-Richards方程<a class="headerlink" href="#aki-richards" title="Permanent link">&para;</a></h3>
<p>Aki-Richards 方程是Zoeppritz 方程的线性近似模拟，代码实现见<a href="#aki-richards-equation">Aki-Richards非线性近似</a></p>
<div class="arithmatex">
<div class="MathJax_Preview">
\begin{array}{ll}
R_P(\theta)=a \frac{\Delta V_P}{2 V_P}+b \frac{\Delta V_S}{2 V_S}+c \frac{\Delta \rho}{2 \rho}, &amp; \text { where }: \\
a=\frac{1}{\cos ^2 \theta}, &amp; \rho=\frac{\rho_2+\rho_1}{2}, \Delta \rho=\rho_2-\rho_1, \\
b=-8 K \sin ^2 \theta, &amp; V_P=\frac{V_{P 2}+V_{P 1}}{2}, \Delta V_P=V_{P 2}-V_{P 1}, \\
c=1-4 K \sin ^2 \theta, &amp; V_S=\frac{V_{S 2}+V_{S 1}}{2}, \Delta V_S=V_{S 2}-V_{S 1}, \\
K=\left(\frac{V_S}{V_P}\right)^2, &amp; \text { and } \theta=\frac{\theta_1+\theta_2}{2} .
\end{array}
</div>
<script type="math/tex; mode=display">
\begin{array}{ll}
R_P(\theta)=a \frac{\Delta V_P}{2 V_P}+b \frac{\Delta V_S}{2 V_S}+c \frac{\Delta \rho}{2 \rho}, & \text { where }: \\
a=\frac{1}{\cos ^2 \theta}, & \rho=\frac{\rho_2+\rho_1}{2}, \Delta \rho=\rho_2-\rho_1, \\
b=-8 K \sin ^2 \theta, & V_P=\frac{V_{P 2}+V_{P 1}}{2}, \Delta V_P=V_{P 2}-V_{P 1}, \\
c=1-4 K \sin ^2 \theta, & V_S=\frac{V_{S 2}+V_{S 1}}{2}, \Delta V_S=V_{S 2}-V_{S 1}, \\
K=\left(\frac{V_S}{V_P}\right)^2, & \text { and } \theta=\frac{\theta_1+\theta_2}{2} .
\end{array}
</script>
</div>
<h3 id="aki-richardswigginsabc-method">Aki-Richards方程的Wiggins形式(ABC method)<a class="headerlink" href="#aki-richardswigginsabc-method" title="Permanent link">&para;</a></h3>
<p>Wiggins(1983)等人发展了一种近似的，重写的方程形式。他们将方程分为三个
反射系数项, 每一个都比前面的项更简单</p>
<div class="arithmatex">
<div class="MathJax_Preview">
R_p(\theta) =  A+B\sin^2(\theta)+C\tan^2(\theta)\sin^2(\theta) 
</div>
<script type="math/tex; mode=display">
R_p(\theta) =  A+B\sin^2(\theta)+C\tan^2(\theta)\sin^2(\theta) 
</script>
</div>
<p>where:</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\begin{aligned}
&amp; A=\frac{1}{2}\left[\frac{\Delta V_P}{V_p}+\frac{\Delta \rho}{\rho}\right], \\
&amp; B=\frac{1}{2} \frac{\Delta V_P}{V_p}-4\left[\frac{V_S}{V_P}\right]^2 \frac{\Delta V_S}{V_S}-2\left[\frac{V_S}{V_P}\right]^2 \frac{\Delta \rho}{\rho}, \\
&amp; C=\frac{1}{2} \frac{\Delta V_P}{V_p} .
\end{aligned}
</div>
<script type="math/tex; mode=display">
\begin{aligned}
& A=\frac{1}{2}\left[\frac{\Delta V_P}{V_p}+\frac{\Delta \rho}{\rho}\right], \\
& B=\frac{1}{2} \frac{\Delta V_P}{V_p}-4\left[\frac{V_S}{V_P}\right]^2 \frac{\Delta V_S}{V_S}-2\left[\frac{V_S}{V_P}\right]^2 \frac{\Delta \rho}{\rho}, \\
& C=\frac{1}{2} \frac{\Delta V_P}{V_p} .
\end{aligned}
</script>
</div>
<p>A是截距, B是梯度, 以及C是曲率,我们把这个方程称为ABC方程</p>
<h3 id="aki-richardsfatti">Aki-Richards方程的Fatti形式<a class="headerlink" href="#aki-richardsfatti" title="Permanent link">&para;</a></h3>
<p>Fatti 等人 (Geophysics, September, 1994) 发展了第三个Aki-Richards方程的
近似公式，被写成:</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\begin{gathered}
R_P(\theta)=c_1 R_P\left(0^{\circ}\right)+c_2 R_S\left(0^{\circ}\right)+c_3 R_D, \text { 其中: } \\
c_1=1+\tan ^2 \theta, c_2=-8 K \sin ^2 \theta, c_3=2 K \sin ^2 \theta-\frac{1}{2} \tan ^2 \theta, K=\left(\frac{V_S}{V_P}\right)^2, \\
R_P\left(0^{\circ}\right)=\frac{1}{2}\left[\frac{\Delta V_P}{V_P}+\frac{\Delta \rho}{\rho}\right], R_S\left(0^{\circ}\right)=\frac{1}{2}\left[\frac{\Delta V_S}{V_S}+\frac{\Delta \rho}{\rho}\right], \text { and } R_D=\frac{\Delta \rho}{\rho} .
\end{gathered}
</div>
<script type="math/tex; mode=display">
\begin{gathered}
R_P(\theta)=c_1 R_P\left(0^{\circ}\right)+c_2 R_S\left(0^{\circ}\right)+c_3 R_D, \text { 其中: } \\
c_1=1+\tan ^2 \theta, c_2=-8 K \sin ^2 \theta, c_3=2 K \sin ^2 \theta-\frac{1}{2} \tan ^2 \theta, K=\left(\frac{V_S}{V_P}\right)^2, \\
R_P\left(0^{\circ}\right)=\frac{1}{2}\left[\frac{\Delta V_P}{V_P}+\frac{\Delta \rho}{\rho}\right], R_S\left(0^{\circ}\right)=\frac{1}{2}\left[\frac{\Delta V_S}{V_S}+\frac{\Delta \rho}{\rho}\right], \text { and } R_D=\frac{\Delta \rho}{\rho} .
\end{gathered}
</script>
</div>
<p>注意到上面的<span class="arithmatex"><span class="MathJax_Preview">R_p(0^\circ)</span><script type="math/tex">R_p(0^\circ)</script></span>项和前面方程中的 A 项是相同的，并且前面两项的系数和原方程是相同的。</p>
<h3 id="aki-richards_1">对于Aki-Richards方程小结<a class="headerlink" href="#aki-richards_1" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th style="text-align: left;">方程名称</th>
<th>权系数</th>
<th>弹性参数</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">Aki-Richards</td>
<td><span class="arithmatex"><span class="MathJax_Preview">a,b,c</span><script type="math/tex">a,b,c</script></span></td>
<td><span class="arithmatex"><span class="MathJax_Preview">\frac{\Delta V_P}{2 V_P}, \frac{\Delta V_S}{2 V_S}, \frac{\Delta \rho}{2 \rho}</span><script type="math/tex">\frac{\Delta V_P}{2 V_P}, \frac{\Delta V_S}{2 V_S}, \frac{\Delta \rho}{2 \rho}</script></span></td>
</tr>
<tr>
<td style="text-align: left;">Wiggins et al</td>
<td><span class="arithmatex"><span class="MathJax_Preview">1,\sin^2(\theta),\tan^2(\theta)\sin^2(\theta)</span><script type="math/tex">1,\sin^2(\theta),\tan^2(\theta)\sin^2(\theta)</script></span></td>
<td><span class="arithmatex"><span class="MathJax_Preview">A,B,C</span><script type="math/tex">A,B,C</script></span></td>
</tr>
<tr>
<td style="text-align: left;">Fatti et al</td>
<td><span class="arithmatex"><span class="MathJax_Preview">c_1,c_2,c_3</span><script type="math/tex">c_1,c_2,c_3</script></span></td>
<td><span class="arithmatex"><span class="MathJax_Preview">R_P\left(0^{\circ}\right), R_S\left(0^{\circ}\right) R_D</span><script type="math/tex">R_P\left(0^{\circ}\right), R_S\left(0^{\circ}\right) R_D</script></span></td>
</tr>
</tbody>
</table>
<p>注意到权系数 b, c 和 c2, c3 包含着 VS/VP 比的平方以及<span class="arithmatex"><span class="MathJax_Preview">\theta</span><script type="math/tex">\theta</script></span>的三角函数. 但是, 在Wiggins等人的方程中, 这个项包含在弹性参数 B 中</p>
<p>下面是对于三个方程的物理学解释:
- 因为地震道包含着波阻抗的变化，而不是只随速度或者只随密度而变化，所以Aki-Richards方程的原始形式很少被使用
- Aki-Richards方程的A, B, C项对于提取有关 AVO 效应的经验信息 (比如 A, 被称为截距, B, 被称为梯度, 以及 C, 被称为曲率)是非常有用的，这些经验信息可以被单独显示分析或者进行交会分析。权系数并不需要有关VP/VS 比的明确信息
- Fatti 等人发展的方程让我们可以提取有关 P 和 S 反射率的定量信息，这可以用来进行叠前反演。RP0 和 RS0 是线性化后的零角度 P和 S 波反射系数</p>
<h3 id="shueyavo">Shuey两项AVO方程<a class="headerlink" href="#shueyavo" title="Permanent link">&para;</a></h3>
<p>Shuey (1985) 使用VP, <span class="arithmatex"><span class="MathJax_Preview">\rho</span><script type="math/tex">\rho</script></span> 和 <span class="arithmatex"><span class="MathJax_Preview">\sigma</span><script type="math/tex">\sigma</script></span> 重写了ABC方程. 仅仅梯度和ABC 方程有所不同:</p>
<div class="arithmatex">
<div class="MathJax_Preview">
B=A\left[D-2(1+D)\frac{1-2\sigma}{1-\sigma}\right]+\frac{\Delta\sigma}{(1-\sigma)^2}
</div>
<script type="math/tex; mode=display">
B=A\left[D-2(1+D)\frac{1-2\sigma}{1-\sigma}\right]+\frac{\Delta\sigma}{(1-\sigma)^2}
</script>
</div>
<p>where:</p>
<div class="arithmatex">
<div class="MathJax_Preview">
D=\frac{\Delta V_p /V_p}{\Delta V_p /V_p+\Delta \rho /\rho}, \sigma = \frac{\sigma_1+\sigma_2}{2},  \Delta\sigma = \sigma_2-\sigma_1
</div>
<script type="math/tex; mode=display">
D=\frac{\Delta V_p /V_p}{\Delta V_p /V_p+\Delta \rho /\rho}, \sigma = \frac{\sigma_1+\sigma_2}{2},  \Delta\sigma = \sigma_2-\sigma_1
</script>
</div>
<p>上面的方程比较复杂，但是通过假设<span class="arithmatex"><span class="MathJax_Preview">\sigma</span><script type="math/tex">\sigma</script></span> = &#8531; (即Vp/Vs=2)，可以被极大地简化成
以下形式:</p>
<div class="arithmatex">
<div class="MathJax_Preview">
B=A\left[D-2(1+D)\frac{1}{2}\right]+\frac{9\Delta\sigma}{4}=2.25\Delta\sigma-A
</div>
<script type="math/tex; mode=display">
B=A\left[D-2(1+D)\frac{1}{2}\right]+\frac{9\Delta\sigma}{4}=2.25\Delta\sigma-A
</script>
</div>
<p>这可以很直观地写成两项AVO方程:</p>
<div class="arithmatex">
<div class="MathJax_Preview">
R_p(\theta) = A + (2.25\Delta\sigma-A)\sin^2\theta
</div>
<script type="math/tex; mode=display">
R_p(\theta) = A + (2.25\Delta\sigma-A)\sin^2\theta
</script>
</div>
<h2 id="avo_1">AVO分析（估计截距与梯度）<a class="headerlink" href="#avo_1" title="Permanent link">&para;</a></h2>
<h3 id="_5">从偏移距道集数据转换到角度道集数据<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h3>
<p>可以使用下面的方式将偏移距道集转换到角度道集: TODO代码实现 </p>
<ul>
<li>直射线假设 (常速度)</li>
<li>射线参数假设 (变速度假设)</li>
<li>射线追踪 (变速度)</li>
</ul>
<p>GPT的回答??</p>
<ol>
<li>读取地震数据</li>
</ol>
<p>使用NumPy的loadtxt函数读取地震数据，数据应该以文本文件的形式存储。</p>
<ol>
<li>将地震数据转换为二维数组</li>
</ol>
<p>将读取的文本数据转换为二维数组，其中每一行代表一个道集。</p>
<ol>
<li>对每个道集进行傅里叶变换</li>
</ol>
<p>使用NumPy的fft函数对每个道集进行傅里叶变换。</p>
<ol>
<li>计算每个道集的偏移距</li>
</ol>
<p>对每个道集进行偏移距计算，将偏移距作为数组的第一维，道数作为数组的第二维，重新组织数组。</p>
<ol>
<li>对每个道集进行反傅里叶变换</li>
</ol>
<p>使用NumPy的ifft函数对每个道集进行反傅里叶变换。</p>
<ol>
<li>将每个道集转换为角度域</li>
</ol>
<p>对每个道集进行Hilbert变换，然后计算相位角度。</p>
<ol>
<li>将每个道集转换为角度道集</li>
</ol>
<p>将每个道集按照角度值重新排列，即可得到角度道集。</p>
<h3 id="_6">拟合一个回归曲线来匹配振幅拾取值，这是一个角度平方的正弦函数关系.<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h3>
<p>属性A和B很少直接被利用。通常，利用的是从这两个属性中计算出其他的 AVO 属
性。</p>
<ul>
<li>AVO积：A*B 的剖面显示了在气藏位置的顶底都为正的反射特征</li>
<li>放大的泊松比变化: A+B 正比于泊松比的变化</li>
<li>剪切反射率: A-B 正比于剪切反射率</li>
<li>流体因子</li>
</ul>
<h2 id="_7">正演相关代码<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h2>
<h3 id="aki-richards_2">Aki-Richards线性近似<a class="headerlink" href="#aki-richards_2" title="Permanent link">&para;</a></h3>
<div class="arithmatex">
<div class="MathJax_Preview">R_{pp}=\zeta(\theta)\varDelta\ln(\alpha)+\eta(\theta)\varDelta\ln(\beta)+\xi(\theta)\varDelta\ln(\rho)</div>
<script type="math/tex; mode=display">R_{pp}=\zeta(\theta)\varDelta\ln(\alpha)+\eta(\theta)\varDelta\ln(\beta)+\xi(\theta)\varDelta\ln(\rho)</script>
</div>
<p>其中</p>
<div class="arithmatex">
<div class="MathJax_Preview">\zeta(\theta)=\frac{1}{\cos ^2 \theta}, b=-8 K \sin ^2 \theta,c=1-4 K \sin ^2 \theta \\
其中 K=\frac12\left(\frac{\beta_1^2}{\alpha_1^2}+\frac{\beta_2^2}{\alpha_2^2}\right)\approx\frac{\beta^2}{\alpha^2}=\left(\frac{V_S}{V_P}\right)^2</div>
<script type="math/tex; mode=display">\zeta(\theta)=\frac{1}{\cos ^2 \theta}, b=-8 K \sin ^2 \theta,c=1-4 K \sin ^2 \theta \\
其中 K=\frac12\left(\frac{\beta_1^2}{\alpha_1^2}+\frac{\beta_2^2}{\alpha_2^2}\right)\approx\frac{\beta^2}{\alpha^2}=\left(\frac{V_S}{V_P}\right)^2</script>
</div>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">createOp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">theta</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Args:</span>
<span class="sd">        theta: 入射角</span>

<span class="sd">    Returns:</span>
<span class="sd">        np.array([G1, G2, G3]): aki-richards方程的系数</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>

    <span class="n">theta</span> <span class="o">=</span> <span class="n">theta</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">vsvp</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">theta</span>
    <span class="n">vsvp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vsvp</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span><span class="o">.</span><span class="n">T</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">vsvp</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">vsvp</span>

    <span class="n">G1</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">0</span> <span class="o">*</span> <span class="n">vsvp</span>
    <span class="n">G2</span> <span class="o">=</span> <span class="o">-</span><span class="mf">4.0</span> <span class="o">*</span> <span class="n">vsvp</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
    <span class="n">G3</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">-</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">vsvp</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">G1</span><span class="p">,</span> <span class="n">G2</span><span class="p">,</span> <span class="n">G3</span><span class="p">])</span>

<span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wav_mtx</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">nt0</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">t0</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Args:</span>
<span class="sd">        wav_mtx: 子波矩阵</span>
<span class="sd">        theta: 入射角</span>
<span class="sd">        nt0: 采样点</span>
<span class="sd">        show: 是否显示合成后的地震数据</span>
<span class="sd">        t0: 采样时间</span>

<span class="sd">    Returns:</span>
<span class="sd">        cal_data: 正演得到的地震数据</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># 单道正演</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ntrace</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">m</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>  <span class="c1"># 注意是按行展平化，所以要先进行转置</span>
        <span class="n">ntheta</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
        <span class="n">G</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">createOp</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
        <span class="c1"># G= np.hstack([Gi for Gi in G])</span>
        <span class="n">D</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">nt0</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">nt0</span><span class="p">),</span> <span class="n">k</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># 差分矩阵</span>
        <span class="n">D</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">D</span> <span class="o">=</span> <span class="n">block_diag</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="n">D</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)])</span>  <span class="c1"># 用列表批量化diag</span>
        <span class="n">G</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">G_</span><span class="p">[</span><span class="n">itheta</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">nt0</span><span class="p">))</span> <span class="k">for</span> <span class="n">G_</span> <span class="ow">in</span> <span class="n">G</span><span class="p">])</span>
                        <span class="k">for</span> <span class="n">itheta</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ntheta</span><span class="p">))</span>  <span class="c1"># 生成可以通过矩阵乘法进行卷积的矩阵</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">W</span> <span class="o">=</span> <span class="n">block_diag</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="n">wav_mtx</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ntheta</span><span class="p">)])</span>  <span class="c1"># 子波矩阵, * 表示遍历</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">G</span> <span class="o">=</span> <span class="n">G</span> <span class="o">@</span> <span class="n">D</span>  <span class="c1"># G in &quot;WGm = d&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">D</span> <span class="o">=</span> <span class="n">D</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">op</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">W</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">D</span><span class="p">))</span>  <span class="c1"># 得到&quot;Ax = b&quot;中的A</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">obs_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">op</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>  <span class="c1"># 计算&quot;Ax&quot;得到合成地震数据/仿真观测数据</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Rpp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">D</span><span class="p">),</span> <span class="n">m</span><span class="p">)</span>  <span class="c1"># 反射系数</span>
        <span class="n">cal_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obs_data</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">ntheta</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>  <span class="c1"># 同样要注意rehsape的次序，所以要先reshpe再转置而不能直接reshape成指定维度</span>
        <span class="k">if</span> <span class="n">show</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">cal_data</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="p">(</span><span class="n">theta</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">theta</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">t0</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">t0</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                        <span class="n">vmin</span><span class="o">=-</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">cal_data</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">vmax</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">cal_data</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;tight&quot;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;incident angle&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;seismic data from Aki-Ri&#39;</span><span class="p">)</span>

    <span class="c1"># 多道正演 仅仅比单道正演多了一维，需要stack</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">m</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ntrace</span><span class="p">)])</span>
        <span class="n">ntheta</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
        <span class="n">G</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">createOp</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
        <span class="c1"># G= np.hstack([Gi for Gi in G])</span>
        <span class="n">D</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">nt0</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">nt0</span><span class="p">),</span> <span class="n">k</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">D</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">D</span> <span class="o">=</span> <span class="n">block_diag</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="n">D</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)])</span>  <span class="c1"># 用列表批量化diag</span>
        <span class="n">Garray</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ntrace</span><span class="p">):</span>
            <span class="n">Gi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">G_</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">itheta</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">nt0</span><span class="p">))</span> <span class="k">for</span> <span class="n">G_</span> <span class="ow">in</span> <span class="n">G</span><span class="p">])</span>
                            <span class="k">for</span> <span class="n">itheta</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ntheta</span><span class="p">))</span>
            <span class="n">Garray</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Gi</span><span class="p">)</span>
        <span class="n">G</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Garray</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">W</span> <span class="o">=</span> <span class="n">block_diag</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="n">wav_mtx</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ntheta</span><span class="p">)])</span>  <span class="c1"># * 表示遍历</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">G</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">G_</span> <span class="o">@</span> <span class="n">D</span> <span class="k">for</span> <span class="n">G_</span> <span class="ow">in</span> <span class="n">G</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">D</span> <span class="o">=</span> <span class="n">D</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">op</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">W</span> <span class="o">@</span> <span class="n">G_</span> <span class="k">for</span> <span class="n">G_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">G</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">obs_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">op</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ntrace</span><span class="p">)])</span>
        <span class="c1"># self.Rpp = np.dot(np.dot(G, D), m)</span>
        <span class="n">cal_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">data</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">ntheta</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">T</span> <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">obs_data</span><span class="p">])</span>  <span class="c1"># 同样要注意rehsape的次序，所以要先reshpe再转置而不能直接reshape成指定维度</span>
        <span class="k">if</span> <span class="n">show</span><span class="p">:</span>  <span class="c1"># 只显示一个剖面</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">cal_data</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="p">(</span><span class="n">theta</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">theta</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">t0</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">t0</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                        <span class="n">vmin</span><span class="o">=-</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">cal_data</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">vmax</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">cal_data</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;tight&quot;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;incident angle&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;seismic data from Aki-Ri&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">cal_data</span>
</code></pre></div>
<h3 id="zoeppritz">Zoeppritz方程<a class="headerlink" href="#zoeppritz" title="Permanent link">&para;</a></h3>
<p>精确Zoeppritz方程</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\begin{align}
\left[\begin{matrix}
R_{pp}\\
R_{ps}\\
T_{pp}\\
T_{ps}
\end{matrix}\right]
=&amp;\left[ \begin{matrix}
\cos(\theta)&amp;-\sin(\delta_r)&amp;\cos(\theta_t)&amp;\sin(\delta_t)\\
\sin(\theta)&amp;\cos(\delta_r)&amp;-\sin(\theta_t)&amp;\cos(\delta_t)\\
-\cos(2\delta_r)&amp;\frac{\beta_1}{\alpha_1}\sin(2\delta_r)&amp;\frac{\rho_2\alpha_2}{\rho_1\alpha_1}\cos(2\delta_t)&amp;\frac{\rho_2\beta_2}{\rho_1\alpha_1}\sin(2\delta_t)\\
\sin(2\theta)&amp;\frac{\alpha_1}{\beta_1}\cos(2\delta_r)&amp;\frac{\rho_2\beta_2^2\alpha_2}{\rho_1\beta_1^2\alpha_1}\sin(2\theta_t)&amp;-\frac{\rho_2\beta_2\alpha_1}{\rho_1\beta_1\beta_1}\cos(2\delta_t)
\end{matrix}\right]^{-1}\times\left[\begin{matrix}
\cos(\theta)\\
\sin(\theta)\\
\cos(2\theta)\\
\sin(2\delta_r)
\end{matrix}\right]\notag\end{align}
</div>
<script type="math/tex; mode=display">
\begin{align}
\left[\begin{matrix}
R_{pp}\\
R_{ps}\\
T_{pp}\\
T_{ps}
\end{matrix}\right]
=&\left[ \begin{matrix}
\cos(\theta)&-\sin(\delta_r)&\cos(\theta_t)&\sin(\delta_t)\\
\sin(\theta)&\cos(\delta_r)&-\sin(\theta_t)&\cos(\delta_t)\\
-\cos(2\delta_r)&\frac{\beta_1}{\alpha_1}\sin(2\delta_r)&\frac{\rho_2\alpha_2}{\rho_1\alpha_1}\cos(2\delta_t)&\frac{\rho_2\beta_2}{\rho_1\alpha_1}\sin(2\delta_t)\\
\sin(2\theta)&\frac{\alpha_1}{\beta_1}\cos(2\delta_r)&\frac{\rho_2\beta_2^2\alpha_2}{\rho_1\beta_1^2\alpha_1}\sin(2\theta_t)&-\frac{\rho_2\beta_2\alpha_1}{\rho_1\beta_1\beta_1}\cos(2\delta_t)
\end{matrix}\right]^{-1}\times\left[\begin{matrix}
\cos(\theta)\\
\sin(\theta)\\
\cos(2\theta)\\
\sin(2\delta_r)
\end{matrix}\right]\notag\end{align}
</script>
</div>
<p>这里我们计算反射系数只用到<span class="arithmatex"><span class="MathJax_Preview">R_{pp}</span><script type="math/tex">R_{pp}</script></span></p>
<p>代码实现</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a1</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">rho1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">b2</span><span class="p">,</span> <span class="n">rho2</span><span class="p">,</span> <span class="n">theta1</span><span class="p">):</span>  <span class="c1"># 单层的反射系数正演</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Args:</span>
<span class="sd">        a1: vp1</span>
<span class="sd">        b1: vs1</span>
<span class="sd">        rho1:</span>
<span class="sd">        a2: vp2</span>
<span class="sd">        b2: vs2</span>
<span class="sd">        rho2:</span>
<span class="sd">        irfwav:</span>
<span class="sd">        ipol:</span>
<span class="sd">        theta1: 入射角度集</span>

<span class="sd">    Returns:</span>
<span class="sd">        当前层反射系数</span>
<span class="sd">        [</span>
<span class="sd">        [&quot;PdPu&quot;, &quot;SdPu&quot;, &quot;PuPu&quot;, &quot;SuPu&quot;],</span>
<span class="sd">        [&quot;PdSu&quot;, &quot;SdSu&quot;, &quot;PuSu&quot;, &quot;SuSu&quot;],</span>
<span class="sd">        [&quot;PdPd&quot;, &quot;SdPd&quot;, &quot;PuPd&quot;, &quot;SuPd&quot;],</span>
<span class="sd">        [&quot;PdSd&quot;, &quot;SdSd&quot;, &quot;PuSd&quot;, &quot;SuSd&quot;],</span>
<span class="sd">        ]</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Create theta1 array of angles in radiants</span>
    <span class="n">theta1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">theta1</span><span class="p">)</span>  <span class="c1"># 转弧度</span>

    <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta1</span><span class="p">)</span> <span class="o">/</span> <span class="n">a1</span>
    <span class="n">theta2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arcsin</span><span class="p">(</span><span class="n">p</span> <span class="o">*</span> <span class="n">a2</span><span class="p">)</span>  <span class="c1"># Trans. angle of P-wave</span>
    <span class="n">phi1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arcsin</span><span class="p">(</span><span class="n">p</span> <span class="o">*</span> <span class="n">b1</span><span class="p">)</span>  <span class="c1"># Refl. angle of converted S-wave</span>
    <span class="n">phi2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arcsin</span><span class="p">(</span><span class="n">p</span> <span class="o">*</span> <span class="n">b2</span><span class="p">)</span>  <span class="c1"># Trans. angle of converted S-wave</span>

    <span class="c1"># Matrix form of Zoeppritz equation</span>

    <span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>  <span class="c1"># shape:[4,4,theta]</span>
        <span class="p">[</span>
            <span class="p">[</span><span class="o">-</span><span class="n">sin</span><span class="p">(</span><span class="n">theta1</span><span class="p">),</span> <span class="o">-</span><span class="n">cos</span><span class="p">(</span><span class="n">phi1</span><span class="p">),</span> <span class="n">sin</span><span class="p">(</span><span class="n">theta2</span><span class="p">),</span> <span class="n">cos</span><span class="p">(</span><span class="n">phi2</span><span class="p">)],</span>
            <span class="p">[</span><span class="n">cos</span><span class="p">(</span><span class="n">theta1</span><span class="p">),</span> <span class="o">-</span><span class="n">sin</span><span class="p">(</span><span class="n">phi1</span><span class="p">),</span> <span class="n">cos</span><span class="p">(</span><span class="n">theta2</span><span class="p">),</span> <span class="o">-</span><span class="n">sin</span><span class="p">(</span><span class="n">phi2</span><span class="p">)],</span>
            <span class="p">[</span>
                <span class="mi">2</span> <span class="o">*</span> <span class="n">rho1</span> <span class="o">*</span> <span class="n">b1</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">phi1</span><span class="p">)</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">theta1</span><span class="p">),</span>
                <span class="n">rho1</span> <span class="o">*</span> <span class="n">b1</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">phi1</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">),</span>
                <span class="mi">2</span> <span class="o">*</span> <span class="n">rho2</span> <span class="o">*</span> <span class="n">b2</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">phi2</span><span class="p">)</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">theta2</span><span class="p">),</span>
                <span class="n">rho2</span> <span class="o">*</span> <span class="n">b2</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">phi2</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">),</span>
            <span class="p">],</span>
            <span class="p">[</span>
                <span class="p">(</span><span class="o">-</span><span class="n">rho1</span><span class="p">)</span> <span class="o">*</span> <span class="n">a1</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">phi1</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">),</span>
                <span class="n">rho1</span> <span class="o">*</span> <span class="n">b1</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">phi1</span><span class="p">),</span>
                <span class="n">rho2</span> <span class="o">*</span> <span class="n">a2</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">phi2</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">),</span>
                <span class="p">(</span><span class="o">-</span><span class="n">rho2</span><span class="p">)</span> <span class="o">*</span> <span class="n">b2</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">phi2</span><span class="p">),</span>
            <span class="p">],</span>
        <span class="p">],</span>
        <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;float&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">N</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>  <span class="c1"># shape:[4,1,theta]</span>
        <span class="p">[</span>
            <span class="p">[</span><span class="n">sin</span><span class="p">(</span><span class="n">theta1</span><span class="p">),</span> <span class="n">cos</span><span class="p">(</span><span class="n">phi1</span><span class="p">),</span> <span class="o">-</span><span class="n">sin</span><span class="p">(</span><span class="n">theta2</span><span class="p">),</span> <span class="o">-</span><span class="n">cos</span><span class="p">(</span><span class="n">phi2</span><span class="p">)],</span>
            <span class="p">[</span><span class="n">cos</span><span class="p">(</span><span class="n">theta1</span><span class="p">),</span> <span class="o">-</span><span class="n">sin</span><span class="p">(</span><span class="n">phi1</span><span class="p">),</span> <span class="n">cos</span><span class="p">(</span><span class="n">theta2</span><span class="p">),</span> <span class="o">-</span><span class="n">sin</span><span class="p">(</span><span class="n">phi2</span><span class="p">)],</span>
            <span class="p">[</span>
                <span class="mi">2</span> <span class="o">*</span> <span class="n">rho1</span> <span class="o">*</span> <span class="n">b1</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">phi1</span><span class="p">)</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">theta1</span><span class="p">),</span>
                <span class="n">rho1</span> <span class="o">*</span> <span class="n">b1</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">phi1</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">),</span>
                <span class="mi">2</span> <span class="o">*</span> <span class="n">rho2</span> <span class="o">*</span> <span class="n">b2</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">phi2</span><span class="p">)</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">theta2</span><span class="p">),</span>
                <span class="n">rho2</span> <span class="o">*</span> <span class="n">b2</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">phi2</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">),</span>
            <span class="p">],</span>
            <span class="p">[</span>
                <span class="p">(</span><span class="n">rho1</span><span class="p">)</span> <span class="o">*</span> <span class="n">a1</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">phi1</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">),</span>
                <span class="o">-</span><span class="n">rho1</span> <span class="o">*</span> <span class="n">b1</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">phi1</span><span class="p">),</span>
                <span class="o">-</span><span class="n">rho2</span> <span class="o">*</span> <span class="n">a2</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">phi2</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">),</span>
                <span class="p">(</span><span class="n">rho2</span><span class="p">)</span> <span class="o">*</span> <span class="n">b2</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">phi2</span><span class="p">),</span>
            <span class="p">],</span>
        <span class="p">],</span>
        <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;float&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># Create Zoeppritz coefficient for all angles</span>
    <span class="n">coef</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">M</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>  <span class="c1"># [4,4,theta]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">M</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>  <span class="c1"># 按角度数遍历</span>
        <span class="n">Mi</span> <span class="o">=</span> <span class="n">M</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span>  <span class="c1"># 第i个角度的所有</span>
        <span class="n">Ni</span> <span class="o">=</span> <span class="n">N</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span>
        <span class="n">icoef</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">Mi</span><span class="p">),</span> <span class="n">Ni</span><span class="p">)</span>  <span class="c1"># M^-1 点乘 N</span>
        <span class="n">coef</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">icoef</span>

    <span class="k">return</span> <span class="n">coef</span>
<span class="k">def</span> <span class="nf">forward_mutil</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">element</span><span class="o">=</span><span class="s2">&quot;PdPu&quot;</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>  <span class="c1"># 多层反射系数正演</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Args:</span>
<span class="sd">        x0: 输入三参数模型</span>
<span class="sd">        element: str</span>
<span class="sd">        [&quot;PdPu&quot;, &quot;SdPu&quot;, &quot;PuPu&quot;, &quot;SuPu&quot;],</span>
<span class="sd">        [&quot;PdSu&quot;, &quot;SdSu&quot;, &quot;PuSu&quot;, &quot;SuSu&quot;],</span>
<span class="sd">        [&quot;PdPd&quot;, &quot;SdPd&quot;, &quot;PuPd&quot;, &quot;SuPd&quot;],</span>
<span class="sd">        [&quot;PdSd&quot;, &quot;SdSd&quot;, &quot;PuSd&quot;, &quot;SuSd&quot;],</span>
<span class="sd">        layer: 层数，即抽样点数</span>

<span class="sd">    Returns:</span>
<span class="sd">        所有层反射系数</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">theta1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">theta</span>
    <span class="n">layer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">layer</span>
    <span class="n">vp</span> <span class="o">=</span> <span class="n">x0</span><span class="p">[:</span><span class="n">layer</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">vs</span> <span class="o">=</span> <span class="n">x0</span><span class="p">[</span><span class="n">layer</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="o">*</span><span class="n">layer</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">rho</span> <span class="o">=</span> <span class="n">x0</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">layer</span><span class="o">+</span><span class="mi">2</span><span class="p">:]</span>
    <span class="n">ntheta</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">theta1</span><span class="p">)</span>
    <span class="n">elements</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="p">[</span><span class="s2">&quot;PdPu&quot;</span><span class="p">,</span> <span class="s2">&quot;SdPu&quot;</span><span class="p">,</span> <span class="s2">&quot;PuPu&quot;</span><span class="p">,</span> <span class="s2">&quot;SuPu&quot;</span><span class="p">],</span>
            <span class="p">[</span><span class="s2">&quot;PdSu&quot;</span><span class="p">,</span> <span class="s2">&quot;SdSu&quot;</span><span class="p">,</span> <span class="s2">&quot;PuSu&quot;</span><span class="p">,</span> <span class="s2">&quot;SuSu&quot;</span><span class="p">],</span>
            <span class="p">[</span><span class="s2">&quot;PdPd&quot;</span><span class="p">,</span> <span class="s2">&quot;SdPd&quot;</span><span class="p">,</span> <span class="s2">&quot;PuPd&quot;</span><span class="p">,</span> <span class="s2">&quot;SuPd&quot;</span><span class="p">],</span>
            <span class="p">[</span><span class="s2">&quot;PdSd&quot;</span><span class="p">,</span> <span class="s2">&quot;SdSd&quot;</span><span class="p">,</span> <span class="s2">&quot;PuSd&quot;</span><span class="p">,</span> <span class="s2">&quot;SuSd&quot;</span><span class="p">],</span>
        <span class="p">]</span>
    <span class="p">)</span>
    <span class="n">coef</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">layer</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">ntheta</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">layer</span><span class="p">):</span>
        <span class="n">a1</span> <span class="o">=</span> <span class="n">vp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">a2</span> <span class="o">=</span> <span class="n">vp</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">b1</span> <span class="o">=</span> <span class="n">vs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">b2</span> <span class="o">=</span> <span class="n">vs</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">rho1</span> <span class="o">=</span> <span class="n">rho</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">rho2</span> <span class="o">=</span> <span class="n">rho</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>

        <span class="n">icoef</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">rho1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">b2</span><span class="p">,</span> <span class="n">rho2</span><span class="p">,</span> <span class="n">theta1</span><span class="p">)</span>
        <span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">elements</span> <span class="o">==</span> <span class="n">element</span><span class="p">)</span>
        <span class="n">coef</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">icoef</span><span class="p">[</span><span class="n">index</span><span class="p">])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ref</span> <span class="o">=</span> <span class="n">coef</span>
    <span class="k">return</span> <span class="n">coef</span>
</code></pre></div>
<h3 id="aki-richards-equation">Aki-Richards-equation非线性近似<a class="headerlink" href="#aki-richards-equation" title="Permanent link">&para;</a></h3>
<p>公式见上面的<a href="#aki-richards">aki-richards方程</a></p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">forward_single_layer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vp1</span><span class="p">,</span> <span class="n">vp2</span><span class="p">,</span> <span class="n">vs1</span><span class="p">,</span> <span class="n">vs2</span><span class="p">,</span> <span class="n">rho1</span><span class="p">,</span> <span class="n">rho2</span><span class="p">,</span> <span class="n">Theta_r</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">        Theta_r: 入射角</span>
<span class="sd">    Returns:</span>
<span class="sd">        Rpp: 单层反射系数</span>
<span class="sd">    Notes:</span>
<span class="sd">        通过单层上下界面参数，计算单层反射系数</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># 计算平均与残差</span>
    <span class="n">vp</span> <span class="o">=</span> <span class="p">(</span><span class="n">vp1</span> <span class="o">+</span> <span class="n">vp2</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">vs</span> <span class="o">=</span> <span class="p">(</span><span class="n">vs1</span> <span class="o">+</span> <span class="n">vs2</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">rho</span> <span class="o">=</span> <span class="p">(</span><span class="n">rho1</span> <span class="o">+</span> <span class="n">rho2</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">dvp</span> <span class="o">=</span> <span class="n">vp2</span> <span class="o">-</span> <span class="n">vp1</span>
    <span class="n">dvs</span> <span class="o">=</span> <span class="n">vs2</span> <span class="o">-</span> <span class="n">vs1</span>
    <span class="n">drho</span> <span class="o">=</span> <span class="n">rho2</span> <span class="o">-</span> <span class="n">rho1</span>

    <span class="c1"># 计算平均角</span>
    <span class="n">Const</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">Theta_r</span><span class="p">)</span> <span class="o">/</span> <span class="n">vp1</span>  <span class="c1"># np中的三角函数必须为弧度制！</span>
    <span class="n">Theta_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arcsin</span><span class="p">(</span><span class="n">Const</span> <span class="o">*</span> <span class="n">vp2</span><span class="p">)</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="p">(</span><span class="n">Theta_r</span> <span class="o">+</span> <span class="n">Theta_t</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>

    <span class="c1"># Aki-Richards方程的系数</span>
    <span class="n">G1</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="p">((</span><span class="mi">1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
    <span class="n">G2</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="p">(</span><span class="n">vs</span> <span class="o">/</span> <span class="n">vp</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">G3</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">4</span> <span class="o">*</span> <span class="p">(</span><span class="n">vs</span> <span class="o">/</span> <span class="n">vp</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>

    <span class="n">G</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">((</span><span class="n">G1</span><span class="p">,</span> <span class="n">G2</span><span class="p">,</span> <span class="n">G3</span><span class="p">))</span><span class="o">.</span><span class="n">T</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">dvp</span> <span class="o">/</span> <span class="n">vp</span><span class="p">,</span> <span class="n">dvs</span> <span class="o">/</span> <span class="n">vs</span><span class="p">,</span> <span class="n">drho</span> <span class="o">/</span> <span class="n">rho</span><span class="p">])</span>

    <span class="n">Rpp</span> <span class="o">=</span> <span class="n">G</span> <span class="o">@</span> <span class="n">m</span>
    <span class="k">return</span> <span class="n">Rpp</span>

<span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wav_mtx</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">nt0</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">t0</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>  <span class="c1"># 目前只做单道</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Args:</span>
<span class="sd">        wav_mtx: 子波矩阵</span>
<span class="sd">        theta: 入射角集</span>
<span class="sd">        nt0: 采样点</span>
<span class="sd">        show: 是否显示合成地震数据</span>
<span class="sd">        t0: 采样时间，用来限定横坐标</span>

<span class="sd">    Returns:</span>
<span class="sd">        Rpp: 整道反射系数</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">thetar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>  <span class="c1"># 转弧度</span>
    <span class="n">Rpp</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">layer</span><span class="p">):</span>
        <span class="n">a1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">a2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vp</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">b1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">b2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vs</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">rho1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rho</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">rho2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rho</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">iRpp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">forward_single_layer</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">b2</span><span class="p">,</span> <span class="n">rho1</span><span class="p">,</span> <span class="n">rho2</span><span class="p">,</span> <span class="n">thetar</span><span class="p">)</span>
        <span class="n">Rpp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">iRpp</span><span class="p">)</span>

    <span class="n">Rpp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Rpp</span><span class="p">)</span>
    <span class="n">Rpp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">Rpp</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">Rpp</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])))</span>  <span class="c1"># 添加全零行，行数补到和采样点数一样</span>
    <span class="n">cal_data</span> <span class="o">=</span> <span class="n">wav_mtx</span><span class="nd">@Rpp</span>
    <span class="k">if</span> <span class="n">show</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">cal_data</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="p">(</span><span class="n">theta</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">theta</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">t0</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">t0</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                    <span class="n">vmin</span><span class="o">=-</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">cal_data</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">vmax</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">cal_data</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;tight&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;incident angle&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;seismic data from Aki-Ri-Nonliner&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">Rpp</span>
</code></pre></div>
<p>偏导数求解为</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\frac{\partial R}{\partial\alpha_i} = \frac{8\sin^2(\theta) (\rho_{i+1} - \rho_{i}) (\beta_{i} + \beta_{i+1})^2}{((\rho_{i} + \rho_{i+1})(\alpha_{i} + \alpha_{i+1})^3)}+\frac{16\sin^2(\theta)(\beta_{i+1}^2 - \beta_{i}^2)}{(\alpha_{i}+ \alpha_{i+1})^3} -\frac{2\alpha_{i+1}} {(\alpha_{i}+ \alpha_{i+1})^2\cos^2(\theta)}
</div>
<script type="math/tex; mode=display">
\frac{\partial R}{\partial\alpha_i} = \frac{8\sin^2(\theta) (\rho_{i+1} - \rho_{i}) (\beta_{i} + \beta_{i+1})^2}{((\rho_{i} + \rho_{i+1})(\alpha_{i} + \alpha_{i+1})^3)}+\frac{16\sin^2(\theta)(\beta_{i+1}^2 - \beta_{i}^2)}{(\alpha_{i}+ \alpha_{i+1})^3} -\frac{2\alpha_{i+1}} {(\alpha_{i}+ \alpha_{i+1})^2\cos^2(\theta)}
</script>
</div>
<div class="arithmatex">
<div class="MathJax_Preview">
\frac{\partial R}{\partial\beta_i}=\frac{-8\sin^2(\theta)(\rho_{i+1}-\rho_i)(\beta_i+\beta_{i+1})}{(\rho_i+\rho_{i+1})(\alpha_i+\alpha_{i+1})^2}+\frac{16\sin^2(\theta)\beta_i}{(\alpha_i+\alpha_{i+1})^2}
</div>
<script type="math/tex; mode=display">
\frac{\partial R}{\partial\beta_i}=\frac{-8\sin^2(\theta)(\rho_{i+1}-\rho_i)(\beta_i+\beta_{i+1})}{(\rho_i+\rho_{i+1})(\alpha_i+\alpha_{i+1})^2}+\frac{16\sin^2(\theta)\beta_i}{(\alpha_i+\alpha_{i+1})^2}
</script>
</div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs"], "search": "../../assets/javascripts/workers/search.dfff1995.min.js", "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.dff1b7c8.min.js"></script>
      
        <script src="../../js/tongji.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdnjs.loli.net/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
    
  </body>
</html>